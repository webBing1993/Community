{extend name="base/common"}

{block name="style"}
<!-- Toastr style -->
<link href="/admin/css/plugins/toastr/toastr.min.css" rel="stylesheet">
<!-- Gritter -->
<link href="/admin/js/plugins/gritter/jquery.gritter.css" rel="stylesheet">
{/block}

{block name="page-header"}
{/block}

{block name="main"}
<div class="wrapper wrapper-content">
    <div class="row">
        <div class="col-lg-3">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <span class="label label-success pull-right">总数</span>
                    <h5>关注用户</h5>
                </div>
                <div class="ibox-content">
                    <h1 class="no-margins">{$userTotal}</h1>
                    <div class="stat-percent font-bold text-success">{$userTotal}</i></div>
                    <small>用户总数</small>
                </div>
            </div>
        </div>
        <div class="col-lg-3">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <span class="label label-info pull-right">总数</span>
                    <h5>活动通知</h5>
                </div>
                <div class="ibox-content">
                    <h1 class="no-margins">{$TenementTotal}</h1>
                    <div class="stat-percent font-bold text-info">{$TenementTotal}</div>
                    <small>活动通知总数</small>
                </div>
            </div>
        </div>
        <div class="col-lg-3">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <span class="label label-primary pull-right">总数</span>
                    <h5>评论</h5>
                </div>
                <div class="ibox-content">
                    <h1 class="no-margins">{$commentTotal}</h1>
                    <div class="stat-percent font-bold text-navy">{$commentTotal}</div>
                    <small>评论总数</small>
                </div>
            </div>
        </div>
        <div class="col-lg-3">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <span class="label label-danger pull-right">总数</span>
                    <h5>课程</h5>
                </div>
                <div class="ibox-content">
                    <h1 class="no-margins">{$courseTotal}</h1>
                    <div class="stat-percent font-bold text-danger">{$courseTotal}</div>
                    <small>课程数</small>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-12">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <h5>用户活跃分析</h5>
                    <div class="pull-right">
                        <div class="btn-group">
                            <!--<button type="button" class="btn btn-xs btn-white">今天</button>-->
                            <!--<button type="button" class="btn btn-xs btn-white">本周</button>-->
                            <!--<button type="button" class="btn btn-xs btn-white active">本月</button>-->
                            <!--<button type="button" class="btn btn-xs btn-white">所有</button>-->
                        </div>
                    </div>
                </div>
                <div class="ibox-content">
                    <div class="row">
                        <div class="col-lg-9">
                            <div class="flot-chart">
                                <div class="flot-chart-content" id="flot-dashboard-chart"></div>
                            </div>
                        </div>
                        <div class="col-lg-3">
                            <ul class="stat-list">
                                <li>
                                    <h2 class="no-margins">{$entyUser|count}</h2>
                                    <small>用户进入总数</small>
                                    <!--<div class="stat-percent">48% <i class="fa fa-level-up text-navy"></i></div>-->
                                    <div class="progress progress-mini">
                                        <div style="width: 48%;" class="progress-bar"></div>
                                    </div>
                                </li>
                                <li>
                                    <h2 class="no-margins ">{$commentTotal}</h2>
                                    <small>评论总数</small>
                                    <!--<div class="stat-percent">60% <i class="fa fa-level-down text-navy"></i></div>-->
                                    <div class="progress progress-mini">
                                        <div style="width: 60%;" class="progress-bar"></div>
                                    </div>
                                </li>
                                <li>
                                    <h2 class="no-margins ">{$viewTotal}</h2>
                                    <small>浏览总数</small>
                                    <!--<div class="stat-percent">22% <i class="fa fa-bolt text-navy"></i></div>-->
                                    <div class="progress progress-mini">
                                        <div style="width: 22%;" class="progress-bar"></div>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-6">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <h5>用户活跃度排行榜</h5>
                    <div class="ibox-tools">
                        <a class="collapse-link">
                            <i class="fa fa-chevron-up"></i>
                        </a>
                        <a class="close-link">
                            <i class="fa fa-times"></i>
                        </a>
                    </div>
                </div>
                <div class="ibox-content">
                    <table class="table table-hover no-margins">
                        <thead>
                        <tr>
                            <th>用户名</th>
                            <th>访问次数</th>
                            <th>最近访问</th>
                            <th>排行</th>
                        </tr>
                        </thead>
                        <tbody>
                        {volist name="userList" id="user"}
                        <tr>
                            <td><small>{$user.name}</small></td>
                            <td>{$user.count}</td>
                            <td><i class="fa fa-clock-o"></i>{$user.login_time|time_format}</td>
                            <td class="text-navy"><i class="fa fa-level-up"></i> {$i} </td>
                        </tr>
                        {/volist}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="col-lg-6">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <h5>部门活跃度排行榜</h5>
                    <div class="ibox-tools">
                        <a class="collapse-link">
                            <i class="fa fa-chevron-up"></i>
                        </a>
                        <a class="close-link">
                            <i class="fa fa-times"></i>
                        </a>
                    </div>
                </div>
                <div class="ibox-content">
                    <table class="table table-hover no-margins">
                        <thead>
                        <tr>
                            <th>部门名称</th>
                            <th>访问次数</th>
                            <th>最近访问</th>
                            <th>排行</th>
                        </tr>
                        </thead>
                        <tbody>
                        {volist name="departmentList" id="department"}
                        <tr>
                            <td><small>{$department.name}</small></td>
                            <td>{$department.count}</td>
                            <td><i class="fa fa-clock-o"></i>{$department.login_time|time_format}</td>
                            <td class="text-navy"> <i class="fa fa-level-up"></i> {$i} </td>
                        </tr>
                        {/volist}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{/block}

{block name="script"}
<!-- Flot -->
<script src="/admin/js/plugins/flot/jquery.flot.js"></script>
<script src="/admin/js/plugins/flot/jquery.flot.tooltip.min.js"></script>
<script src="/admin/js/plugins/flot/jquery.flot.spline.js"></script>
<script src="/admin/js/plugins/flot/jquery.flot.resize.js"></script>
<script src="/admin/js/plugins/flot/jquery.flot.pie.js"></script>
<script src="/admin/js/plugins/flot/jquery.flot.symbol.js"></script>
<script src="/admin/js/plugins/flot/jquery.flot.time.js"></script>
<script type="text/javascript">
    /* 插件块关闭操作 */
    $(".title-opt .wm-slide").each(function(){
        $(this).click(function(){
            $(this).closest(".columns-mod").find(".bd").toggle();
            $(this).find("i").toggleClass("mod-up");
        });
    })
</script>
<script>
    $(document).ready(function() {
//        var data2 = [
//            [gd(2012, 1, 1), 7], [gd(2012, 1, 2), 6], [gd(2012, 1, 3), 4], [gd(2012, 1, 4), 8],
//            [gd(2012, 1, 5), 9], [gd(2012, 1, 6), 7], [gd(2012, 1, 7), 5], [gd(2012, 1, 8), 4],
//            [gd(2012, 1, 9), 7], [gd(2012, 1, 10), 8], [gd(2012, 1, 11), 9], [gd(2012, 1, 12), 6],
//            [gd(2012, 1, 13), 4], [gd(2012, 1, 14), 5], [gd(2012, 1, 15), 11], [gd(2012, 1, 16), 8],
//            [gd(2012, 1, 17), 8], [gd(2012, 1, 18), 11], [gd(2012, 1, 19), 11], [gd(2012, 1, 20), 6],
//            [gd(2012, 1, 21), 6], [gd(2012, 1, 22), 8], [gd(2012, 1, 23), 11], [gd(2012, 1, 24), 13],
//            [gd(2012, 1, 25), 7], [gd(2012, 1, 26), 9], [gd(2012, 1, 27), 9], [gd(2012, 1, 28), 8],
//            [gd(2012, 1, 29), 5], [gd(2012, 1, 30), 8], [gd(2012, 1, 31), 25]
//        ];
        var data3 = [{$entyUserStr}];
        var dataset = [
            {
                label: "用户进入总数",
                data: data3,
                color: "#1ab394",
                bars: {
                    show: true,
                    align: "center",
                    barWidth: 24 * 60 * 60 * 600,
                    lineWidth:0
                }
            }
        ];
        var options = {
            xaxis: {
                mode: "time",
                tickSize: [3, "day"],
                tickLength: 0,
                axisLabel: "Date",
                axisLabelUseCanvas: true,
                axisLabelFontSizePixels: 12,
                axisLabelFontFamily: 'Arial',
                axisLabelPadding: 10,
                color: "#d5d5d5"
            },
            yaxes: [{
                position: "left",
//                max: 10,
                color: "#d5d5d5",
                axisLabelUseCanvas: true,
                axisLabelFontSizePixels: 12,
                axisLabelFontFamily: 'Arial',
                axisLabelPadding: 3
            }
            ],
            legend: {
                noColumns: 1,
                labelBoxBorderColor: "#000000",
                position: "nw"
            },
            grid: {
                hoverable: false,
                borderWidth: 0
            }
        };
        function gd(year, month, day) {
            return new Date(year, month - 1, day).getTime();
        }
        var previousPoint = null, previousLabel = null;
        $.plot($("#flot-dashboard-chart"), dataset, options);
    });
</script>
{/block}