{extend name="public/common"}

{block name="style"}
<title>审核列表</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<link rel="stylesheet" href="/home/css/framework7.ios.colors.css">
<link rel="stylesheet" href="/home/css/framework7.ios.css">
<link rel="stylesheet" href="/home/css/weui.css">
<style>
    body{
        background-color: #f1f1f1;
        margin: 0;
        padding: 0;
        font-size: 0;
        font-family: "Microsoft yahei",sans-serif;
    }
    .top {
        width: 100%;
        background: #fff;
        height: 44px;
        color: #666;
        font-size:16px;
        line-height: 44px;
        text-align: center;
    }
    .list-block {
        margin: 10px 0;
    }
    .list-block li {
        margin: 10px 0;
        background-color: #fff;
        height:90px;
    }
    .list-block ul {
        background-color: #f1f1f1;
    }
    .swipeout-content{
        height:90px;
        padding-left: 10px;
    }
    .swipeout-content img {
        border-radius: 4px;
        margin: 10px 0;
        width: 70px;
        height: 70px;
        float: left;
    }
    .list{
        float:left;
        height:90px;
        width:72vw;
        position:relative;
    }
    .list .title {
        float: left;
        width: 62vw;
        margin: 10px 10px;
        font-size: 16px;
        color: #111;
        text-overflow: -o-ellipsis-lastline;
        overflow: hidden;
        text-overflow: ellipsis;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
    }
    .list .sent_time {
        display: block;
        width: 62vw;
        font-size: 12px;
        color: #999;
        padding-left: 10px;
        position:absolute;
        bottom:10px;
    }
    .list .sent_time>span:last-child{
        display:inline-block;
        float:right;
    }
    .arrow{
        float:left;
    }
    .arrow>img{
        width:20px;
        height:20px;
        display:block;
        margin-top:35px;
    }
    .list-block .swipeout-actions-right a {
        padding: 0 15px;
    }
    .green{
        background-color:#3bc355 !important;
    }
    .red{
        background-color:#f61530!important;
    }
    .navTop{
        height:44px;
        background-color:#fff;
    }
    .navTop>a{
        color: #666;
        font-size: 16px;
        line-height: 44px;
        display:block;
        float:left;
        width:50vw;
        text-align: center;
    }
    .navTop>img{
        width:20px;
        height:20px;
        position:absolute;
        right: 10px;
        top:12px;
        z-index:100;
    }
    .navTop>a.active{
        color:#ff7043;
    }
    .navTop>a.active:after{
        content:'';
        display:block;
        margin:0 auto;
        height:1px;
        width:21.3vw;
        border-bottom: 2px solid #ff7043;
        margin-top:-2px;
    }
    .weui_mask {
        position: fixed;
        z-index: 10000;
        width: 100%;
        height: 100%;
        top: 0;
        left: 0;
        background: rgba(0, 0, 0, 0.4);
    }
    .list-block .swipeout-actions-left a, .list-block .swipeout-actions-right a {
        padding: 0 20px;
        font-size:16px;
    }
    .initials{
        color:#666;
    }
    .weui_dialog{
        width:70.6vw;
        border-radius: 6px;
        z-index:10001;
    }
    .weui_dialog>.head{
        text-align: center;
        color:#333;
        font-size:14px;
    }
    .weui_dialog>.head>p{
        height:60px;
        line-height: 60px;
        font-size: 14px;
        color:#333;
        margin:0;
    }
    .weui_dialog>.head>div{
        height:45px;
        color:#999;
    }
    .weui_dialog_ft {
        margin: 0;
    }
    .weui_dialog_ft>a {
        height: 50px;
        line-height: 50px;
        font-size: 14px;
        color:#333;
    }
    .red1{
        color:#e51c23!important;
    }
    .modal1{
        width: 100vw;
        min-height: 100vh;
        background-color:rgba(0,0,0,.3);
        position:absolute;
        z-index:100000;
        top:0;
        left:0;
    }
    .modal1>.icon1{
        width:100vw;
        height:auto;
    }
    .modal1>.close1{
        width:30px;
        height:30px;
        position:fixed;
        top:10px;
        right:10px;
    }
    .modal1>p{
        font-size: 14px;
    }
    a:hover{
        text-decoration: none;
    }
    .page-content {
        background-color: rgba(0,0,0,.3);
        top:-45px;
        z-index: 200;
        visibility: hidden;
        height:0px;
    }
    .swiper-slide>span{
        font-size: 14px;
    }
    .swiper-container {

    }
    .swiper-slide {
        background:#fff;
    }
    .swiper-slide img {
        text-align:center;
        display:block;
         height:97vh;
        width:97vw;
        margin:0 auto;
        margin-top:3vh;
    }
    .page-content>img{
        width:30px;
        height:30px;
        position:fixed;
        right:0px;
        top:0px;
        z-index: 400;
    }
</style>
{/block}

{block name="body"}
<div class="views">
    <div class="navTop" id="navTop">
        <a class="active" data-number="#list-block-company">企业号</a>
        <a data-number="#list-block">订阅号</a>
        <img src="/home/images/score1.png" alt="" id="help">
    </div>
    <!--帮助框-->
    <div class="page-content" id="page-content" style="height:0px;">
        <!-- Slider -->
        <img src="/home/images/close1.png" alt="" id="close">
        <div class="swiper-container">
            <div class="swiper-wrapper">
                <div class="swiper-slide"><img src="/home/images/help1.jpg" alt=""></div>
                <div class="swiper-slide"><img src="/home/images/help2.jpg" alt=""></div>
                <div class="swiper-slide"><img src="/home/images/help3.jpg" alt=""></div>
                <div class="swiper-slide"><img src="/home/images/help4.jpg" alt=""></div>
                <div class="swiper-slide"><img src="/home/images/help5.jpg" alt=""></div>
            </div>
            <div class="swiper-pagination"></div>
        </div>
    </div>
    <!--企业号-->
    <div class="list-block" id="list-block-company">
        <ul>
            {volist name="list" id="vo"}
            {eq name="vo.type" value="1"}
            <li class="swipeout">
                <div class="swipeout-content">
                    <img src="{$vo.image|get_cover='path'}" alt="封面图片">
                    <div class="list">
                        <span class="title">{$vo.title}</span>
                        <span class="sent_time">
                            <span>发布人：{$vo.create_user}</span>
                            <span>{$vo.create_time|time_format="Y.m.d"}</span>
                        </span>
                    </div>
                    <div class="arrow">
                        <img src="/home/images/rightArrow.png" alt="">
                    </div>
                </div>
                <div class="swipeout-actions-right">
                    <a class="green" onclick="dispose(this,{$vo.id},{$vo.type},1)">通&emsp;过</a>
                    <a class="red" onclick="dispose(this,{$vo.id},{$vo.type},-1)">不通过</a>
                </div>
            </li>
            {/eq}
            {/volist}
        </ul>
    </div>
    <!--订阅号-->
    <div class="list-block" id="list-block" style="display:none">
        <ul>
            {volist name="list" id="vo"}
            {eq name="vo.type" value="2"}
            <li class="swipeout">
                <div class="swipeout-content">
                    <img src="{$vo.image|get_cover='path'}" alt="封面图片">
                    <div class="list">
                        <span class="title">{$vo.title}</span>
                        <span class="sent_time">
                            <span>发布人：{$vo.create_user}</span>
                            <span>{$vo.create_time|time_format="Y.m.d"}</span>
                        </span>
                    </div>
                    <div class="arrow">
                        <img src="/home/images/rightArrow.png" alt="">
                    </div>
                </div>
                <div class="swipeout-actions-right">
                    <a class="green" onclick="dispose(this,{$vo.id},{$vo.type},1)">通&emsp;过</a>
                    <a class="red" onclick="dispose(this,{$vo.id},{$vo.type},-1)">不通过</a>
                </div>
            </li>
            {/eq}
            {/volist}
        </ul>
    </div>
</div>

<!--用户确认弹出框-->
<div class="weui_dialog_confirm" id="alert" style="display:none">
    <div class="weui_mask"></div>
    <div class="weui_dialog">
        <div class="head">
            <p>提醒</p>
            <div>确认当前操作吗？</div>
        </div>
        <div class="weui_dialog_ft">
            <a  class="weui_btn_dialog red1 ok" id="ok">确认</a>
            <a  class="weui_btn_dialog default " id="cancel1">取消</a>
        </div>
    </div>
</div>
{/block}

{block name="script"}
<script src="/home/js/framework7.js"></script>
<script>
    var myApp=new Framework7;
    var $$=Dom7;
//    帮助打开界面
    $('#help').click(function(){
        $('#page-content').css('height','100vh').css('visibility','visible');
        $('.views').css('overflow','hidden');
    })
//    帮助关闭按钮
    $('#close').click(function(){
        $('#page-content').css('height','0').css('visibility','hidden');
        $('.views').css('overflow','auto');
    });
    $('#navTop>a').click(function(){
        $('#navTop>a.active').removeClass('active');
        $('.list-block').hide();
        $(this).addClass('active');
        $($(this).attr('data-number')).show();
    });
    //提醒取消
    $('#cancel1').click(function(){
        $('.weui_dialog_confirm').hide();
    });

    function dispose(i,id,type,status){
        var me=i;//this保存
        $('#alert').show();
        $('#ok').unbind('click');
        $('#ok').one('click', function(){
            $.ajax({
                type: "post",
                url: "{:Url('Focus/review')}",
                data: {id:id,type:type,status:status},
                dataType: "json",
                success: function(data){
                    $('#alert').hide();
                    $(me).parent().parent().hide();//当前点击的隐藏;
                }
            });
        })
    }

     var mySwiper = myApp.swiper('.swiper-container', {
        pagination:'.swiper-pagination',
    });
</script>
{/block}